<?xml version="1.0" encoding="utf-8"?>

<config>
    <global>
        <defaultSnapshot>ICABase</defaultSnapshot>
        <LisaInitScript>
            <file>.\setupScripts\CreateVMs.ps1</file>
        </LisaInitScript>
        <imageStoreDir>\\unc\path</imageStoreDir>
         <testParams>
            <param>vmCpuNumber=4</param>
            <param>vmMemory=4GB</param>
        </testParams>
    </global>
    <testSuites>
        <suite>
            <suiteName>lisnext</suiteName>
            <suiteTests>
                <<suiteTest>install_kernel_gcov</suiteTest>
                <suiteTest>MainVM_Checkpoint</suiteTest>
                <suiteTest>Core</suiteTest>
                <suiteTest>Network</suiteTest>
                <suiteTest>Network-IPv6</suiteTest>
                <suiteTest>FCopy</suiteTest>
                <suiteTest>KVP</suiteTest>
                <suiteTest>Storage</suiteTest>
                <suiteTest>Stress</suiteTest>
                <suiteTest>Sriov</suiteTest>
                <suiteTest>Runtime-Memory</suiteTest>
                <suiteTest>DM</suiteTest>
                <suiteTest>VMBus</suiteTest>
                <suiteTest>VSS</suiteTest>
                <suiteTest>hv-sock</suiteTest>
                <suiteTest>Overall</suiteTest>
            </suiteTests>
        </suite>
    </testSuites>
    <testCases>
        <test>
        <testName>install_kernel_gcov</testName>
        <PreTest>setupScripts\copyLatestItem.ps1</PreTest>
        <testScript>BuildKernelWithPatches.sh</testScript>
        <files>remote-scripts/ica/BuildKernelWithPatches.sh,remote-scripts/ica/utils.sh</files>
        <timeout>3600</timeout>
        <onError>Abort</onError>
        <testParams>
            <param>TC_COVERED=lis-rpms-01</param>
            <param>SOURCE_TYPE=RPM</param>
            <param>ACTIVATE_GCOV=yes</param>
            <param>localDest=tools</param>
            <param>ITEM=*.src.rpm</param>
        </testParams>
        </test>
        <test>
            <testName>Network</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=network</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>Network-IPv6</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=network-ipv6</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>Stress</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=stress</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>Sriov</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=sriov</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>Overall</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=overall</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>KVP</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=kvp</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>Core</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=core</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>FCopy</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=fcopy</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>Storage</testName>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=storage</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>Runtime-Memory</testName>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=runtime-memory</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>DM</testName>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=dm</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>VMBus</testName>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=VMBus</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>

        <test>
            <testName>VSS</testName>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=vss</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>hv-sock</testName>
            <setupScript>
                <file>setupscripts\RevertSnapshot.ps1</file>
            </setupScript>
            <testScript>SetupScripts\CreateGcovReport.ps1</testScript>
            <timeout>600</timeout>
            <testParams>
                <param>TC_COVERED=GCov-Report</param>
                <param>testArea=hv-sock</param>
            </testParams>
            <OnError>Continue</OnError>
        </test>
        <test>
            <testName>MainVM_Checkpoint</testName>
            <testScript>setupscripts\PreVSS_TakeSnapshot.ps1</testScript>
            <timeout>600</timeout>
               <testParams>
                <param>TC_COVERED=snapshot</param>
                <param>snapshotVm=main</param>
                <param>snapshotName=ICABase</param>
            </testParams>
            <onError>Continue</onError>
            <noReboot>False</noReboot>
        </test>
    </testCases>
    <VMs>
        <vm>
            <hvServer>localhost</hvServer>
            <vmName>gcov-create-report</vmName>
            <os>Linux</os>
            <ipv4></ipv4>
            <sshKey>rhel5_id_rsa.ppk</sshKey>
            <suite>lisnext</suite>
            <testParams>
                <param>SSH_PRIVATE_KEY=rhel5_id_rsa</param>
                <param>snapshotName=ICABase</param>
            </testParams>
            <hardware>
                <create>true</create>
                <numCPUs>8</numCPUs>
                <memSize>8192</memSize>
                <disableDiff>true</disableDiff>
                <nic>VMBus,External,001600112313</nic>
                <generation>1</generation>
            </hardware>
        </vm>
    </VMs>
</config>